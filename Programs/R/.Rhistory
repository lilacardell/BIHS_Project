# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(num_visited_sixmo, na.rm = TRUE),
#     sd = sd(num_visited_sixmo, na.rm = TRUE)
#   )
w_kcal_workervisit=hh_BMI_workervisits%>%
as_survey_design(ids=vcode, strata=dvcode,weights=popweightR1)%>%
summarise_all(survey_mean,na.rm=TRUE)
#descriptive statistics
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(BMI, na.rm = TRUE),
#     sd = sd(BMI, na.rm = TRUE)
#   )
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(num_visited_sixmo, na.rm = TRUE),
#     sd = sd(num_visited_sixmo, na.rm = TRUE)
#   )
w_kcal_workervisit=hh_kcal_workervisits%>%
as_survey_design(ids=vcode, strata=dvcode,weights=popweightR1)%>%
summarise_all(survey_mean,na.rm=TRUE)
#descriptive statistics
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(BMI, na.rm = TRUE),
#     sd = sd(BMI, na.rm = TRUE)
#   )
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(num_visited_sixmo, na.rm = TRUE),
#     sd = sd(num_visited_sixmo, na.rm = TRUE)
#   )
w_kcal_workervisit=hh_kcal_workervisit%>%
as_survey_design(ids=vcode, strata=dvcode,weights=popweightR1)%>%
summarise_all(survey_mean,na.rm=TRUE)
#hh level inadequacy LOOK AT ME
hh_kcal_inad=kcal_inadequacy%>%
group_by(hhid,vcode,dvcode,popweightR1,hhweightR1)%>%
#dplyr::summarise(across(starts_with("kcal"),mean,na.rm=TRUE))%>%
dplyr::summarise(actual_inadequate_FAO_grp=mean(actual_inadequate_FAO_grp,na.rm=TRUE))%>%
ungroup()%>%
mutate(any_kcal_inadequate=if_else(actual_inadequate_FAO_grp>0,1,0))
#use hh_FAO_age_hh_inadequate
# Outcomes:
# Average BMI among children in a household
# Portion of children under median BMI within a household by WHO Recommendations
# If a household has any children with inadequacy (average of the BMI inadequacy variables >0 → inadequacy exists)
# task:create kcal and BMI inadequacy variables needed
#BMI inadequate
hh_BMI=kcal_inadequacy%>%
filter(age<18)%>%
group_by(hhid,vcode,dvcode,popweightR1,hhweightR1)%>%
dplyr::summarise(across(starts_with("BMI"),mean,na.rm=TRUE))%>%
ungroup()%>%
mutate(any_BMI_inadequate=if_else(BMI_inadequate_FAO_age>0,1,0))
# Predictors:
# Whether a household has been visited by health workers in last 6 months
# Number of health workers’ visits in last 6 months (categorize 0~2)
hh_workervisits = w.hh.roster_2011%>%
dplyr::select(hhid, visit_sixmo, num_visited_sixmo)
# merge and only keep distinct rows
hh_BMI_workervisits = left_join(hh_BMI,hh_workervisits,by=c("hhid"))
hh_kcal_workervists = left_join(hh_kcal_inad, hh_workervisits, by=c("hhid"))
#descriptive statistics
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(BMI, na.rm = TRUE),
#     sd = sd(BMI, na.rm = TRUE)
#   )
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(num_visited_sixmo, na.rm = TRUE),
#     sd = sd(num_visited_sixmo, na.rm = TRUE)
#   )
w_BMI_workervisit=hh_BMI_workervisits%>%
as_survey_design(ids=vcode, strata=dvcode,weights=popweightR1)%>%
summarise_all(survey_mean,na.rm=TRUE)
#ANOVA
# levels: visited or not
hh_BMI_workervisits$visit_sixmo <- ordered(hh_BMI_workervisits$visit_sixmo,
levels = c(0, 1))
# Compute the analysis of variance
res.aov <- aov(BMI ~ visit_sixmo, data = hh_BMI_workervisits)
# Summary of the analysis
summary(res.aov)
#descriptive statistics
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(BMI, na.rm = TRUE),
#     sd = sd(BMI, na.rm = TRUE)
#   )
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(num_visited_sixmo, na.rm = TRUE),
#     sd = sd(num_visited_sixmo, na.rm = TRUE)
#   )
w_kcal_workervisit=hh_kcal_workervisits%>%
as_survey_design(ids=vcode, strata=dvcode,weights=popweightR1)%>%
summarise_all(survey_mean,na.rm=TRUE)
#hh level inadequacy LOOK AT ME
hh_kcal_inad=kcal_inadequacy%>%
group_by(hhid,vcode,dvcode,popweightR1,hhweightR1)%>%
#dplyr::summarise(across(starts_with("kcal"),mean,na.rm=TRUE))%>%
dplyr::summarise(actual_inadequate_FAO_grp=mean(actual_inadequate_FAO_grp,na.rm=TRUE))%>%
ungroup()%>%
mutate(any_kcal_inadequate=if_else(actual_inadequate_FAO_grp>0,1,0))
#use hh_FAO_age_hh_inadequate
# Outcomes:
# Average BMI among children in a household
# Portion of children under median BMI within a household by WHO Recommendations
# If a household has any children with inadequacy (average of the BMI inadequacy variables >0 → inadequacy exists)
# task:create kcal and BMI inadequacy variables needed
#BMI inadequate
hh_BMI=kcal_inadequacy%>%
filter(age<18)%>%
group_by(hhid,vcode,dvcode,popweightR1,hhweightR1)%>%
dplyr::summarise(across(starts_with("BMI"),mean,na.rm=TRUE))%>%
ungroup()%>%
mutate(any_BMI_inadequate=if_else(BMI_inadequate_FAO_age>0,1,0))
# Predictors:
# Whether a household has been visited by health workers in last 6 months
# Number of health workers’ visits in last 6 months (categorize 0~2)
hh_workervisits = w.hh.roster_2011%>%
dplyr::select(hhid, visit_sixmo, num_visited_sixmo)
# merge and only keep distinct rows
hh_BMI_workervisits = left_join(hh_BMI,hh_workervisits,by=c("hhid"))
hh_kcal_workervists = left_join(hh_kcal_inad, hh_workervisits, by=c("hhid"))
#descriptive statistics
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(BMI, na.rm = TRUE),
#     sd = sd(BMI, na.rm = TRUE)
#   )
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(num_visited_sixmo, na.rm = TRUE),
#     sd = sd(num_visited_sixmo, na.rm = TRUE)
#   )
w_kcal_workervisit=hh_kcal_workervisits%>%
as_survey_design(ids=vcode, strata=dvcode,weights=popweightR1)%>%
summarise_all(survey_mean,na.rm=TRUE)
#hh level inadequacy LOOK AT ME
hh_kcal_inad=kcal_inadequacy%>%
group_by(hhid,vcode,dvcode,popweightR1,hhweightR1)%>%
#dplyr::summarise(across(starts_with("kcal"),mean,na.rm=TRUE))%>%
dplyr::summarise(actual_inadequate_FAO_grp=mean(actual_inadequate_FAO_grp,na.rm=TRUE))%>%
ungroup()%>%
mutate(any_kcal_inadequate=if_else(actual_inadequate_FAO_grp>0,1,0))
#use hh_FAO_age_hh_inadequate
# Outcomes:
# Average BMI among children in a household
# Portion of children under median BMI within a household by WHO Recommendations
# If a household has any children with inadequacy (average of the BMI inadequacy variables >0 → inadequacy exists)
# task:create kcal and BMI inadequacy variables needed
#BMI inadequate
hh_BMI=kcal_inadequacy%>%
filter(age<18)%>%
group_by(hhid,vcode,dvcode,popweightR1,hhweightR1)%>%
dplyr::summarise(across(starts_with("BMI"),mean,na.rm=TRUE))%>%
ungroup()%>%
mutate(any_BMI_inadequate=if_else(BMI_inadequate_FAO_age>0,1,0))
# Predictors:
# Whether a household has been visited by health workers in last 6 months
# Number of health workers’ visits in last 6 months (categorize 0~2)
hh_workervisits = w.hh.roster_2011%>%
dplyr::select(hhid, visit_sixmo, num_visited_sixmo)
# merge and only keep distinct rows
hh_BMI_workervisits = left_join(hh_BMI,hh_workervisits,by=c("hhid"))
hh_kcal_workervisits = left_join(hh_kcal_inad, hh_workervisits, by=c("hhid"))
#descriptive statistics
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(BMI, na.rm = TRUE),
#     sd = sd(BMI, na.rm = TRUE)
#   )
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(num_visited_sixmo, na.rm = TRUE),
#     sd = sd(num_visited_sixmo, na.rm = TRUE)
#   )
w_kcal_workervisit=hh_kcal_workervisits%>%
as_survey_design(ids=vcode, strata=dvcode,weights=popweightR1)%>%
summarise_all(survey_mean,na.rm=TRUE)
#ANOVA
# levels: visited or not
hh_kcal_workervisits$visit_sixmo <- ordered(hh_BMI_workervisits$visit_sixmo,
levels = c(0, 1))
#descriptive statistics
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(BMI, na.rm = TRUE),
#     sd = sd(BMI, na.rm = TRUE)
#   )
# group_by(hh_BMI_workervisits, hhid) %>%
#   summarise(
#     count = n(),
#     mean = mean(num_visited_sixmo, na.rm = TRUE),
#     sd = sd(num_visited_sixmo, na.rm = TRUE)
#   )
w_kcal_workervisit=hh_kcal_workervisits%>%
as_survey_design(ids=vcode, strata=dvcode,weights=popweightR1)%>%
summarise_all(survey_mean,na.rm=TRUE)
#ANOVA
# levels: visited or not
hh_kcal_workervisits$visit_sixmo <- ordered(hh_kcal_workervisits$visit_sixmo,
levels = c(0, 1))
# Compute the analysis of variance
res.aov <- aov(any_kcal_inadequate ~ visit_sixmo, data = hh_kcal_workervisits)
# Summary of the analysis
summary(res.aov)
hh_kcal_workervisits_num = hh_kcal_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,any_kcal_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
lmVisit = lm(any_kcal_inadequate~num_visited_sixmo, data = hh_kcal_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
hh_kcal_workervisits_num = hh_kcal_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,any_kcal_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
lmVisit = lm(any_kcal_inadequate~num_visited_sixmo, data = hh_kcal_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_kcal_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
View(hh_kcal_workervists)
View(hh_kcal_workervisits_num)
View(hh_kcal_workervists)
hh_kcal_workervisits_num = hh_kcal_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,actual_inadequate_FAO_grp)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
lmVisit = lm(actual_inadequate_FAO_grp~num_visited_sixmo, data = hh_kcal_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_kcal_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
View(hh_BMI_workervisits)
hh_kcal_workervisits_num = hh_kcal_workervisits%>%
#filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,actual_inadequate_FAO_grp)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
lmVisit = lm(actual_inadequate_FAO_grp~num_visited_sixmo, data = hh_kcal_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_kcal_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_kcal_workervisits_num = hh_kcal_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,actual_inadequate_FAO_grp)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
lmVisit = lm(actual_inadequate_FAO_grp~num_visited_sixmo, data = hh_kcal_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_kcal_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_kcal_workervisits_num = hh_kcal_workervisits%>%
#filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,any_kcal_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
lmVisit = lm(any_kcal_inadequate~num_visited_sixmo, data = hh_kcal_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_kcal_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_kcal_workervisits_num = hh_kcal_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,any_kcal_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
lmVisit = lm(any_kcal_inadequate~num_visited_sixmo, data = hh_kcal_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_kcal_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
#filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,any_BMI_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(any_BMI_inadequate~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,any_BMI_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(any_BMI_inadequate~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
#filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
filter(BMI > 18.5)%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
filter(BMI < 18.5)%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_kcal_workervisits_num = hh_kcal_workervisits%>%
filter(visit_sixmo == 1)%>%
filter(BMI < 18.5)%>%
dplyr::select(num_visited_sixmo,any_kcal_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
filter(BMI < 18.5)%>%
dplyr::select(num_visited_sixmo,any_BMI_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(any_BMI_inadequate~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
filter(BMI > 18.5)%>%
dplyr::select(num_visited_sixmo,any_BMI_inadequate)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(any_BMI_inadequate~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,BMI_gap_FAO_age)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI_gap_FAO_age~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
#filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,BMI_gap_FAO_age)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI_gap_FAO_age~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
dplyr::select(num_visited_sixmo,BMI_gap_FAO_age)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI_gap_FAO_age~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
View(kcal_inadequacy)
#hh level inadequacy LOOK AT ME
hh_kcal_inad=kcal_inadequacy%>%
group_by(hhid,vcode,dvcode,popweightR1,hhweightR1)%>%
#dplyr::summarise(across(starts_with("kcal"),mean,na.rm=TRUE))%>%
dplyr::summarise(actual_inadequate_FAO_grp=mean(actual_inadequate_FAO_grp,na.rm=TRUE))%>%
ungroup()%>%
mutate(any_kcal_inadequate=if_else(actual_inadequate_FAO_grp>0,1,0))
#use hh_FAO_age_hh_inadequate
# Outcomes:
# Average BMI among children in a household
# Portion of children under median BMI within a household by WHO Recommendations
# If a household has any children with inadequacy (average of the BMI inadequacy variables >0 → inadequacy exists)
# task:create kcal and BMI inadequacy variables needed
#BMI inadequate
hh_BMI=kcal_inadequacy%>%
filter(age<18)%>%
group_by(hhid,vcode,dvcode,popweightR1,hhweightR1,age_range)%>%
dplyr::summarise(across(starts_with("BMI"),mean,na.rm=TRUE))%>%
ungroup()%>%
mutate(any_BMI_inadequate=if_else(BMI_inadequate_FAO_age>0,1,0))
# Predictors:
# Whether a household has been visited by health workers in last 6 months
# Number of health workers’ visits in last 6 months (categorize 0~2)
hh_workervisits = w.hh.roster_2011%>%
dplyr::select(hhid, visit_sixmo, num_visited_sixmo)
# merge and only keep distinct rows
hh_BMI_workervisits = left_join(hh_BMI,hh_workervisits,by=c("hhid"))
hh_kcal_workervisits = left_join(hh_kcal_inad, hh_workervisits, by=c("hhid"))
View(hh_BMI)
head(hh_BMI$age_range)
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
filter(age_range = "Older Adolescent (14-17)")%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
filter(age_range == "Older Adolescent (14-17)")%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
filter(age_range == "Older Adolescent (14-17)")%>%
# filter(age_range == "Young Adolescent (11-13)")%>%
# filter(age_range == "Older Child (8-10)")%>%
# filter(age_range == "Young Child (4-7)")%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
#filter(age_range == "Older Adolescent (14-17)")%>%
filter(age_range == "Young Adolescent (11-13)")%>%
# filter(age_range == "Older Child (8-10)")%>%
# filter(age_range == "Young Child (4-7)")%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
#filter(age_range == "Older Adolescent (14-17)")%>%
#filter(age_range == "Young Adolescent (11-13)")%>%
filter(age_range == "Older Child (8-10)")%>%
# filter(age_range == "Young Child (4-7)")%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
#filter(age_range == "Older Adolescent (14-17)")%>%
#filter(age_range == "Young Adolescent (11-13)")%>%
# filter(age_range == "Older Child (8-10)")%>%
filter(age_range == "Young Child (4-7)")%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
hh_BMI_workervisits_num = hh_BMI_workervisits%>%
filter(visit_sixmo == 1)%>%
# filter(age_range == "Older Adolescent (14-17)")%>%
# filter(age_range == "Young Adolescent (11-13)")%>%
# filter(age_range == "Older Child (8-10)")%>%
# filter(age_range == "Young Child (4-7)")%>%
dplyr::select(num_visited_sixmo,BMI)%>%
filter(num_visited_sixmo<24) # only for now drop out the outlier
#hh_BMI_workervisits_num = hh_BMI_workervisits_num[c("BMI", "num_visited_sixmo")]
lmVisit = lm(BMI~num_visited_sixmo, data = hh_BMI_workervisits_num) #Create the linear regression
summary(lmVisit) #Review the results
plot(hh_BMI_workervisits_num, pch = 16, col = "blue") #Plot the results
abline(lmVisit) #Add a regression line
